起底国家级 APT 组织之海莲花（APT-Q-31）：
东南亚地区的不散梦魇 

国家级 APT（Advanced Persistent Threat，高级持续性威胁）组织
是有国家背景支持的专注于针对特定目标进行长期持续性网络攻击
的顶尖黑客团伙。奇安信旗下的高级威胁研究团队红雨滴（RedDrip 
Team）在每年发布的全球 APT 年报【1】、中报里都会对当年各大 APT
团伙的活动进行分析总结。接下来，我们将起底全球各地区主要活跃
的 APT 组织。 

今天，我们介绍的是将目标锁定在东南亚地区最为活跃的 APT
组织：OceanLotus（海莲花），奇安信内部跟踪编号为 APT-Q-31。该
组织是以中国为主要攻击目标的 APT 团伙之一，由奇安信红雨滴团
队（前身为天眼实验室）最早披露并命名。 

一、背景 

OceanLotus（海莲花）又名 APT32、SeaLotus 等称号，是一个据
称有东南亚背景的APT组织，其攻击活动最早可追溯到2012年4月，
在首次披露的攻击活动中攻击目标涵盖了中国海事机构、海域建设部
门、科研院所和航运企业。OceanLotus 自首次披露以来持续活跃至今，
后续针对中国境内的攻击活动扩展到几乎所有重要机构，包括政府部
门、科研院所、境内高校和金融投资机构。 

根据各安全厂商机构对该组织活动的拼图式揭露，OceanLotus 除
针对中国发起攻击之外，其攻击所涉及的国家地区分布非常广泛，包
括越南周边国家（如柬埔寨、泰国、老挝等）和欧洲地区，该组织的
攻击目标还包括越南的异见人士、人权代表、媒体、环保组织等。 

OceanLotus 的攻击不局限于国家级网络间谍活动，也延伸至商业
情报窃取，比如汽车制造行业。在 2019 年，丰田、现代、宝马等跨
国汽车企业被报道遭到 OceanLotus 攻击导致数据泄露。另外
OceanLotus 被观察到进行加密货币挖矿。2020 年 7 月至 8 月该组织
在针对法国和越南私营部门以及政府机构的攻击中，将门罗币矿机程
序部署在受害主机上。 

二、 攻击特点手段、工具 

OceanLotus 拥有非常高的社会工程学技巧，常用鱼叉攻击和水坑
攻击，在近年来的攻击活动中还采用了供应链攻击手法对高价值目标
进行渗透。OceanLotus 的攻击武器覆盖多平台，已知具有针对
Windows 和 Mac OS 系统的攻击工具，疑似具备针对 Android 和 Linux
平台的恶意软件，该组织擅长结合公开的商业或开源工具实施攻击活
动，比如 Cobalt Strike，Mimikatz。随着攻击活动不断被安全厂商曝
光，OceanLotus 也在不断升级自己的攻击手法，通过白利用、多阶段
加载、代码混淆加密等手段加强隐蔽性，规避检测与追踪。从过往
OceanLotus 攻击活动中，总结出该组织具有以下特点： 

1. 精通目标国家语言，熟悉目标国家时事新闻热点以及政府组
织结构，能够制作出极具迷惑性的攻击诱饵； 

2. 能够组织长周期大规模的攻击活动，综合使用鱼叉攻击、水坑
攻击、社工攻击、供应链攻击等多种手法入侵高价值目标，一旦获得
一台机器的控制权，便会扫描整个内网并横向移动以扩大感染面，
OceanLotus 在入侵和横向移动过程中具备利用 0day/Nday 漏洞的能
力； 

3. 不断增强恶意代码隐蔽性以规避检测，常用的手法包括利用
系统白名单程序、应用软件 DLL 劫持（白加黑）、多阶段加载、代
码混淆加密； 

4. 为了隐藏真实身份，经常变换下载服务器和 C2 服务器的域名
和 IP，而且大多数域名为了抵抗溯源都开启了 Whois 域名隐藏，使
得分析人员很难知道恶意域名背后的注册者，还曾在历史攻击活动中
使用 DGA（域名生成算法）进一步逃避检测追踪。 

（一）攻击手段 

1. 鱼叉攻击 

OceanLotus 制作的鱼叉邮件大都具有非常本土化的邮件主题，贴
合目标国家的时事热点，迷惑性极强，并且使用的攻击诱饵类型多样，
在历次攻击活动中出现过以下类型攻击诱饵： 

(1) 携带恶意宏或漏洞利用的 Office 文档； 

(2) 使用 word 程序图标进行伪装的可执行文件； 

(3) 合法可执行文件加恶意 DLL（白加黑）诱饵； 

(4)  Chm 文件诱饵； 

(5)  Lnk 文件诱饵； 

(5)  Hta 文件诱饵； 

(6)  携带 CVE-2018-20250 漏洞的 WinRAR 压缩包； 

(7)  SFX 自解压文件。 

2. 水坑攻击 

OceanLotus 采用两种手段制作水坑：攻陷合法网站植入恶意
Javascript 代码，或者搭建伪装为合法网站的恶意网站。OceanLotus 通
过水坑网站除了直接向目标系统投递恶意软件，还结合社会工程学手
段制作钓鱼页面窃取攻击目标的邮箱账号。 

3. 社工攻击 

社会工程学也是 OceanLotus 常用的攻击手段，该组织曾在
Facebook 等平台上伪造身份为活动家和商业实体的角色。OceanLotus
为了使这些虚构人物或者组织显得更真实可信，会在多个互联网服务
平台上伪造相关信息。该组织在互联网上创建的一些社交页面被设计
来用来吸引特定的关注者，以便后续进行定向的网络钓鱼或者下发恶
意软件。 

4. 供应链攻击 

OceanLotus 在最近几年的攻击活动中开始采用供应链攻击方式，
向攻击目标组织机构的 IT 服务商发起攻击，通过感染上游 IT 服务
商，并借助网络边界设备（如 VPN）的漏洞进入攻击目标的内网。 

（二）使用工具及技术特征 

OceanLotus 使用的网络武器包括制作水坑网站的 Javascript 恶意
代码框架、针对 Windows 和 Mac OS 系统的恶意软件。此外，安全厂
商还披露了与 OceanLotus 组织存在关联的 Android 和 Linux 平台恶
意软件。 

1. 水坑网站 Javascript 恶意代码框架 

OceanLotus 通过植入的 Javascript 恶意代码追踪网站访问者，并
收集访问者设备信息，然后对目标人员采取对应攻击行动。Javascript
代码具有如下特征： 

(1) 多阶段加载，植入第一阶段 Javascript 代码负责检测运行环
境，并根据检测结果决定是否从 C2 获取第二阶段 Javascript 代码； 

(2) 第二阶段 Javascript 为开源项目 fingerprintjs2 的修改版，作用
是收集访问设备的信息并加密传递给第二阶段 C2； 

(3) 根据收集的用户设备信息判断是否属于攻击目标，只向攻击
目标下发 Javascript 攻击代码实施后续攻击行为。 

2. Windows 平台 

OceanLotus针对Windows系统的攻击工具包括Denis木马、Remy
木马、Cobalt Strike 木马以及 KerrDown 下载器，其中由 Cobalt Strike
生成的木马最常见。除此之外 OceanLotus 还使用 Powershell 脚本和
公开工具（如 Mimikatz、nbtscan）进行内网渗透和横向移动。 

OceanLotus 在 Windows 平台的攻击活动具有如下特征： 

(1) 多阶段加载 

恶意代码从植入目标系统到最终远控运行通常会经历多阶段加
载，后续载荷获取方式包括：从当前载荷自身数据提取、读取其他文
件数据以及从 C2 服务器下载。 

(2) 代码混淆加密 

为了避免检测分析，OceanLotus 恶意代码在每个阶段的载荷基本
都会经过加密处理，使用的加密算法包括各类 XOR 加密和对称加密
（比如 RC4、AES）。OceanLotus 还曾使用过图片隐写技术隐藏后续
载荷，具体做法是将后续载荷的加密数据存放在 png 类型图片像素的
最低有效位。从 2019 年开始，OceanLotus 植入目标系统的后门出现
定制化特点，即后续载荷需要用与目标主机某个特征标识（比如主机
名、IP 地址或者 MAC 地址）的 hash 值作为密钥才能成功解密，该
方法不仅增强了恶意软件的隐蔽性，也极大阻碍了安全人员对其攻击
行为的分析与追踪。 

除了加密，OceanLotus 还经常使用各种代码混淆手段对抗静态分
析。此外，OceanLotus 有时也会在恶意程序文件末尾中填充大量无效
数据，增加文件尺寸，干扰一些安全软件的检测分析。 

(3) 白利用 

OceanLotus 会使用一系列白利用手法绕过杀毒软件检测，曾使用
过 Windows 系统白名单程序 odbcconf、msbuild 执行恶意软件。该组
织使用最多的白利用手法是 DLL 劫持（白加黑），即可执行文件都
是带有数字签名的正常应用程序，而与之相关的 DLL 文件被替换为
了恶意 DLL。 

(4) 远控后门与 C2 服务器通信方式除了常规的 TCP 协议，还使
用过 DNS 隧道和 ICMP 协议。 

(5) 远控后门既有直接连接 C2 服务器类型，也有创建命名管道
等待连接和监听端口等待连接类型。 

3. Mac OS 平台 

OceanLotus 针对 Mac OS 平台的后门功能为收集操作系统信息上
传 C2 服务器和接收执行 C2 指令。后门通常由植入恶意软件中的
dropper 组件释放，dropper 还负责建立持久化，以及修改后门程序文
件时间戳增加其隐蔽性。与 Windows 平台类似，Mac OS 平台的后门
借助加密隐藏关键字符串。此外，Mac OS 平台后门在后续改进升级
过程中还具备了反调试和反沙箱功能。 

4. Android 平台 

2020年卡巴斯基披露了一类通过安卓应用商店（比如Google Play）
分发的木马应用，由于该类安卓木马在代码特征上与 OceanLotus 
MacOS 后门有一些相似之处，并且使用的 C2 服务器与 OceanLotus 
Windows 后门存在重叠，故这类安卓木马被认为是 OceanLotus 的
Android 平台后门。 

此类安卓木马将经过 AES 加密后的恶意载荷嵌入应用之中（比
如放置在应用资源文件夹下）。恶意载荷的 manifest 清单文件中不包
含任何权限申请，权限获取通过调用未在官方文档记录中的 Android 
API 实现。 

5. Linux 平台 

2021 年披露的 Linux 平台后门 RotaJakiro（双头龙）因与
OceanLotus 的 Mac OS 后门样本在代码特征上有诸多相似之处，被认
为与 OceanLotus 相关。 

RotaJakiro 采用了动态生成的 AES 加密常量表，双层加密的通信
协议等技术对抗安全人员的二进制和网络流量分析。该后门在运行时
会根据当前用户是否为 root 用户执行不同的持久化、进程守护以及单
一实例策略，使用 AES 和 rotate 的组合算法解密敏感数据。 

三、著名历史攻击事件 

（一）OceanLotus 首次曝光 

2015 年，OceanLotus 对中国政府、科研院所、海事机构、海域建
设、航运企业等重要领域实施的不间断攻击被曝光【5】，使得该组织首
次为世人所知。该组织主要通过鱼叉攻击和水坑攻击等方法，配合多
种社会工程学手段进行渗透，向境内特定目标人群传播特种木马程序，
秘密控制部分政府人员、外包商和行业专家的电脑系统，窃取系统中
相关领域的机密资料。 

2014 年 2 月以后，OceanLotus 进入攻击活跃期，并于 2014 年 5
月发动了最大规模的一轮鱼叉攻击，大量受害者因打开带毒的邮件附
件而感染特种木马。而在 2014 年 5 月、9 月，以及 2015 年 1 月，该
组织又对多个政府机构、科研院所和涉外企业的网站进行篡改和挂马，
发动了多轮次、有针对性的水坑攻击。 

（二）Cobalt Kitty 行动 

2017 年安全厂商 cybereason 披露了 OceanLotus 针对跨国企业的
商业机密窃取行动 ”Cobalt Kitty” 【6】。OceanLotus 通过向公司高层管理
人员投递鱼叉钓鱼邮件入侵了副总裁、高级主管和运营部门其他关键
人员的计算机，共攻陷了 40 多台 PC 和服务器，包括域控服务器、
文件服务器、Web 服务器和数据库服务器。在此次攻击活动中，
OceanLotus 利用对微软、谷歌和卡巴斯基应用程序的 DLL 劫持启动
后门，并使用了以微软 Outlook 为 C2 通信信道的新型后门。 

（三）大规模网络攻击 

2017 年 5 月 Volexity 发现 OceanLotus 发动了针对 ASEAN（东南
亚国家联盟）、周边国家（柬埔寨、中国、老挝、菲律宾）以及越南
境内人权组织、新闻媒体、民主团体组织的大规模网络攻击活动【7】，
超过 100 个组织或个体网站被攻陷。 

OceanLotus 在攻陷网站的网页中植入恶意 Javascript 代码，对特
定组织和个人展开定向攻击，结合社交工程学手段在攻击目标的系统
中安装恶意软件或者窃取目标的邮箱账号。OceanLotus 在此次攻击中
创建了大量模拟合法网络服务提供商（比如 Akamai、百度、Cloudfare、
Google）的域名，使用的基础设施横跨多个托管服务提供商和国家。

（四）针对东南亚地区的水坑攻击 

2018 年 11 月 ESET 披露了 OceanLotus 新一轮水坑攻击【3】。这
轮水坑攻击至少起始于当年 9 月，披露时已确定被攻陷的网站有 21
个，涉及柬埔寨国防部、柬埔寨外交与国际合作部以及越南新闻和博
客网站。OceanLotus 在此次水坑攻击中开始使用非对称密码进行 AES
会话密钥的交换，会话密钥用来加密与 C2 服务器的通信数据，从而
避免最终载荷被安全防护产品截取。另外攻击者还将 HTTP 协议切换
为 WebSocket 协议进一步隐藏通信数据。 

（五）PhantomLance 攻击行动 

2020年卡巴斯基发现了一类通过安卓应用商店分发的木马应用，
称之为” PhantomLance”攻击行动【4】，认为该攻击行动与 OceanLotus
有关。Bitdefender 发现这个针对 Android 平台的攻击行动可追溯至
2014 年【8】。 

在几乎所有恶意软件部署案例中，攻击者都试图通过创建仅包含
虚假的最终用户许可协议(EULA)的 Github 帐户来构建虚假的开发人
员资料。攻击者采用如下手段在应用商店发布恶意安卓应用：上传到
应用商店的初始版本不包含任何恶意载荷或用于释放恶意载荷的代
码，从而绕过应用商店的检测，再通过后续版本更新向应用中加入恶
意载荷和代码以释放并执行这些恶意载荷。在这些恶意应用中，除了常见的诱饵应用程序（例如 Flash 插件、清理程序和更
新程序）外，还有一些专门针对越南地区的应用程序，可以看出越南
属于木马应用的目标投放区域。 

（六）借助伪造网站的水坑攻击 

2020 年 Volexity 披露 OceanLotus 建立运营了多个伪造为维权、
新闻和反腐败主题的网站，并借此向特定的网站访问者发起水坑攻击
【9】。该组织还运营了与伪造网站相关的 Facebook 账户，用以提高网
站的可信度。根据伪造网站的主题内容可以判断这些攻击活动的目标
区域包括越南及其周边国家。在披露之后，Facebook 采取行动禁用了
与伪造网站相关的 Facebook 账户，并将攻击活动关联到越南一家名
为 CyberOne 的 IT 公司【10】。 

四、总结 

总体而言，OceanLotus 的攻击目标集中在越南周边国家和越南本
土的人权、环保和新闻媒体等组织机构。该组织发动的攻击活动周期
长、攻击使用的基础设施数量多分布广、攻击的针对性和手法复杂度
都很高，可以看出该组织背后强大的国家政府支持。OceanLotus 自曝
光以来一直处于活跃状态，不断升级改进攻击手段以对抗分析与追踪，
而且将中国作为主要攻击目标之一，值得引起我们的高度重视。