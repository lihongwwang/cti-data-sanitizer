包括安天在内的安全厂商曾发布过关于白象的多份分析报告[1]，报告揭露的攻击主要集中在PC端，攻击手段往往以鱼叉攻击和钓鱼攻击为主，移动端的攻击并不多见。然而，由于移动互联网的发展，个人手机往往除了包含个人隐私之外，也会带有使用者的社会属性，基于该因素，针对移动端的攻击也成为了整个攻击链条中的重要一环。在此，安天移动安全联合猎豹移动，将揭露白象组织针对我国的一起移动端攻击事件。

1.样本基本信息

该样本伪装为正常应用，被安装运行后便隐藏图标，并在后台释放恶意子包。其可接收远程控制指令，窃取用户短信、联系人、通话记录、地理位置、浏览器记录等隐私信息，私自下载apk、拍照、录音，并将用户隐私上传至服务器，给用户隐私安全造成危害。

2.样本分析
该应用启动后会打开LicenseService服务：

该服务会开启f线程用于注册和释放间谍子包：

注册url：http://ckoen.dmkatti.com

动态加载间谍子包：

子包分析：
主包反射调用com.android.preferences.AndroidR类的Execute方法：

建立socket连接：

socket地址：mtk.baimind.com
该地址用于与手机建立通讯，发送控制指令和上传短信、联系人、通话记录、地理位置、浏览器记录等部分隐私信息。

此外该间谍子包还建立了https通讯用于上传录音、截图、文档、相片、电影等大文件：

https地址：https://jang.goongnam.com/resource/request.php

签名Subject中包含HackingTeam，Christian Pozz(可能为Hacking team的一个管理员)字样，同时代码中的注册功能，可以认定是对外出售的商业间谍软件：

结合安天移动安全移动威胁情报分析系统，我们推断mtk.baimind.com属于白象组织。

3.拓展分析
根据注册CC的同源性，我们查找到如下样本（倾向认为属于hacking team）

和我们分析的样本不同，以上样本有了明显的功能改进，增加了提权功能。以45AE1CB1596E538220CA99B29816304F为例，对其assets目录名为dataOff.db的文件进行解密，解密之后的文件中带有提权配置文件，如下所示：

由此可见，hacking team在发生代码泄漏之后,该组织CEO表示泄漏的代码只是很小一部分的言论是有依据的，另一方面也从侧面反映出商业军火商一定程度上降低了APT攻击的门槛，使得网络攻击具有更多的不确定性。

4.总结
该样本伪装WPS Office办公应用，攻击目标为我国大陆地区用户，该间谍应用窃取大量用户隐私，带来严重的信息泄露风险，这一一定程度上反映了我国是网络攻击的主要受害国之一的事实。在移动互联网的大潮之下，保障网络安全也是所有安全厂商的责任与义务，面对越来越多的mAPT事件，安全厂商应该持续关注并提升对抗能力，为移动安全保驾护航。