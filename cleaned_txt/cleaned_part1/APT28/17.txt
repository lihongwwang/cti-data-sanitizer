**APT-C-20（APT28）使用复合攻击战术的攻击活动分析**

APT-C-20（APT28）也被称为Fancy Bear、Sofacy或Sednit，活跃于网络空间已有十多年，其攻击目标遍及全球多个国家和地区，涉及政府、军事、媒体、能源等多个关键领域。

该组织以其高超的技术手段和复杂的攻击策略而闻名。他们善于利用多种攻击载体，如鱼叉式网络钓鱼邮件、水坑攻击、零日漏洞等，并结合多种技术手段，如恶意软件、远程控制工具、加密通信协议等，实现对目标系统的渗透和控制。同时，APT28也非常重视对攻击行为的掩盖和伪装，通过使用代理服务器、伪造文件属性等手段，增加了溯源和归因的难度。

本报告将重点分析和剖析其三类最为活跃的攻击战术，深入揭示APT28在近期攻击活动中的侵入路径、使用工具、技战术以及背后的战略意图。

### **一、攻击活动分析**

#### **1. 类别一：Headlace**

**攻击流程分析**
在典型的攻击场景中，APT28的攻击者首先向目标用户发送精心构造的钓鱼邮件，邮件正文通常包含指向恶意压缩文件的链接。一旦用户下载并打开压缩文件，Headlace Dropper会使用伪装手段诱导用户执行例如文件名为Windows更新、网页链接或者图标伪装为文档的LNK文件等。在某些情况下，攻击者还会利用DLL劫持技术，在用户打开合法应用时加载Headlace Dropper。

除了恶意压缩文件，攻击者还使用LNK快捷方式文件和恶意URL等多种诱饵格式。一旦Headlace Dropper成功执行，它会进一步释放功能更强大的Headlace后门程序。该后门能够与C2服务器建立通信，在受害系统上执行窃取敏感信息、下载额外恶意组件等操作，实现长期控制。

**恶意载荷分析**
攻击始于向目标发送包含恶意链接的电子邮件。在投递负载前，攻击者会利用JavaScript进行一系列验证（如检查用户代理是否包含特定关键词以识别虚拟机），并确认受害者地理位置，实施地理围栏以筛选目标、提高攻击精准度。

验证通过后，攻击者会投放精心伪装的恶意压缩文件（如伪装成Windows更新或模特图片）。压缩文件内含恶意CMD代码，其主要功能是创建并执行BAT文件和VBS文件，同时打开诱饵网站（如模特网站）或展示虚假的更新进度以迷惑受害者。

恶意BAT文件会利用Microsoft Edge浏览器的“headless”模式访问指定URL，在系统目录中创建、移动、执行并最终删除一个恶意脚本文件以隐藏痕迹。

在近期攻击中，攻击者还使用DLL劫持技术：在压缩包内植入易受攻击的合法Calc.exe程序，诱使用户执行，从而加载恶意DLL文件，该DLL的功能同样是下载并执行后续恶意载荷。

该恶意脚本的目的是收集用户计算机上的敏感信息（如文件目录列表、IP地址、地理位置）并发送到远程服务器。

#### **2. 类别二：Masepie**

**攻击流程分析**
攻击者向目标用户发送包含恶意链接的钓鱼邮件。用户点击链接后，会被重定向到精心设计的诱饵页面，并诱导点击特定按钮。点击后，用户会被引导至一个WebDAV服务器，服务器上预置了恶意的LNK快捷方式文件。

双击LNK文件会触发恶意活动：通过PowerShell命令释放多个组件，包括诱饵文档、Python解释器以及名为MASEPIE的后门程序。一旦MASEPIE后门执行，攻击者便能建立稳定的远程控制通道，可根据需要下发其他攻击组件（如STEELHOOK或OCEANMAP），以进一步扩大控制，并在受害者系统上执行任意命令。

**恶意载荷分析**
初始阶段，用户点击邮件中的虚假链接后，会看到一个模糊的诱饵文档图像（如冒充欧盟太空计划署的文件），诱使用户点击按钮以查看完整文档。

点击按钮后，恶意代码会利用JavaScript和search-ms协议的特性，在后台下载一个LNK文件。LNK文件会加载一个远程诱饵文档，然后通过远程Python解释器执行恶意Python代码。

这个恶意Python文件属于Masepie恶意软件家族，具有文件上传、下载以及命令执行等功能。样本首先连接远程C2服务器，发送一个随机生成的AES密钥和系统用户名。

连接建立后，样本进入无限循环，持续接收并执行服务器下发的命令，包括：
*   `check`：发送“check-ok”消息确认连接状态。
*   `send_file`：启动线程接收文件。
*   `get_file`：从受害者计算机上传文件到服务器。
*   其他命令：直接在受害者计算机上执行命令并返回结果。

#### **3. 类别三：钓鱼**

**攻击流程分析**
攻击者向目标发送精心设计的钓鱼邮件，邮件附件通常是恶意压缩文件，内含诱人的PDF文档或HTML文件。用户打开压缩文件并访问其中的PDF时，会被引导至一个恶意HTML钓鱼页面。用户在该页面上被引诱填写账户凭据，这些信息会被攻击者窃取，用于后续的渗透和情报收集。

**恶意载荷分析**
观察发现多起针对乌克兰的钓鱼攻击。邮件附件为恶意压缩文件，内含伪装成ukr.net登录或密码修改页面的钓鱼HTML文件或诱饵PDF文档。

受害者点击诱饵PDF中的按钮后，会跳转至托管在Mocky上的伪装成ukr.net的钓鱼网页以窃取凭据。

钓鱼HTML文件包含恶意JavaScript代码，使用XMLHttpRequest对象将捕获的用户凭证发送到远程C2服务器，并根据服务器返回的特定字符串动态更新网页内容，例如显示“身份验证完成”、重定向到真实网站、提示错误或要求重新输入等，以增强欺骗性。

### **二、归属研判**

早期国外安全机构通报指出APT28组织利用Headlace和Masepie等恶意组件实施网络攻击。本次分析发现，相关攻击活动已扩展至欧洲及高加索地区其他国家。

这些攻击活动中使用的钓鱼手法，与APT28一贯采用的技术和战术完全吻合。此外，攻击者利用被入侵的Ubiquiti Edge路由器收集用户凭证的手法，此前已被多个安全研究机构披露，并与APT28的攻击特征高度匹配。

综合以上分析，有充分理由认为这一系列攻击活动是由APT28组织策划和实施的。

### **三、防范排查建议**

根据对APT28典型攻击活动的分析，建议组织采取以下防范和排查措施：
1.  定期开展网络安全教育和培训，提高员工对钓鱼邮件、恶意附件和可疑链接的识别与防范能力。
2.  建立明确的安全政策和程序，要求员工谨慎处理来源不明或可疑的邮件和附件。
3.  启用操作系统和应用程序的自动更新功能，及时修补已知漏洞。
4.  限制普通用户的管理权限，减少恶意软件的潜在影响范围。
5.  定期对组织的网络、系统和应用进行全面的安全评估和漏洞扫描。
6.  组建专业的安全事件响应团队。
7.  对关键信息资产实施严格的访问控制、加密保护，并建立备份和恢复机制。

希望这份清洗后的内容对您的威胁分析工作有所帮助。如果您需要我针对其中某一部分（如特定恶意软件的技术细节或防御措施）进行更深入的提取或总结，请随时提出。