GRU’s BlueDelta Targets Key Networks in Europe with Multi-Phase Espionage Campaigns

Executive Summary
As Russia’s war against Ukraine persists, Russia is applying all of its resources to gain a strategic advantage. Over the past year, Insikt Group has tracked the evolution of BlueDelta’s operational infrastructure, which was used to deploy its information-stealing malware Headlace in three distinct phases between April and December 2023. This activity overlaps with activity previously attributed by Insikt Group, the Computer Emergency Response Team of Ukraine (CERT-UA), and others to APT28 or Fancy Bear, which we attribute to the Main Directorate of the General Staff of the Armed Forces of the Russian Federation (GRU).

Throughout the three phases, BlueDelta used phishing emails, legitimate internet services (LIS), and living off-the-land binaries (LOLBins) to extract intelligence from key networks across Europe. They have engaged in credential harvesting campaigns aimed at Yahoo and UKR[.]net users, as well as dedicated victim mail servers. BlueDelta’s recent operations have targeted the Ukrainian Ministry of Defence, Ukrainian weapons import and export companies, European railway infrastructure enterprises, and a think tank based in Azerbaijan.

BlueDelta's espionage activities reflect a broader strategy aimed at gathering intelligence on entities with military significance to Russia in the context of its ongoing aggression against Ukraine. This focus is consistent with their objective to uncover operational capabilities and potential vulnerabilities within Ukraine's defense sector. Additionally, BlueDelta’s attention to institutions such as the Azerbaijan Center for Economic and Social Development think tank extends this strategy, aiming to collect intelligence on regional strategic policies and developments.

BlueDelta’s tactics, which primarily involve credential capture for initial access, are engineered to mimic regular network traffic, making detection difficult. Some of BlueDelta’s credential harvesting pages can bypass two-factor authentication by relaying requests between legitimate services and compromised Ubiquiti routers, increasing their effectiveness. The abuse of LIS, such as GitHub, to host redirection scripts also complicates the identification of malicious activity. Throughout these campaigns, BlueDelta has continuously refined its operations, demonstrating notable sophistication and adaptability.

Critical sectors targeted by BlueDelta, including government, military, defense, energy, transportation, and think tanks, must bolster their awareness and defenses against these tactics. Security training should prioritize identifying characteristics of BlueDelta’s phishing emails. We recommend restricting access to non-essential free services often exploited by BlueDelta. Organizations using targeted email services like Yahoo and UKR[.]net should implement strict security measures, including two-factor authentication and close monitoring for suspicious activity.

BlueDelta has been observed conducting espionage using Headlace malware against targets in Europe by using phishing emails, legitimate internet services, and living off-the-land binaries. The group regularly updates and improves its operational infrastructure, indicating sophistication and agility. Since March 2022, BlueDelta has conducted regular credential harvesting campaigns targeting Yahoo and UKR[.]net webmail service users. BlueDelta’s campaigns targeted Ukraine’s Ministry of Defence, Ukrainian weapons import and export companies, and a think tank in Azerbaijan, with the most recent campaigns observed in February and March 2024. This targeting matches Russia’s strategic interests, with a strong focus on gathering information to support its war effort in Ukraine, as well as monitoring the geopolitical landscape of neighboring countries and North Atlantic Treaty Organization (NATO) members. BlueDelta uses credential harvesting pages that can defeat two-factor authentication and CAPTCHA challenges by relaying requests between legitimate services and compromised Ubiquiti routers.

Background
On September 4, 2023, CERT-UA reported a phishing campaign that leveraged Headlace malware to target a critical energy infrastructure facility in Ukraine. During this campaign, BlueDelta sent phishing emails from a fake sender address that contained links to archive files. The archive files contained lure images and Windows BAT script, which, if executed, would result in the whoami command being run and the results being exfiltrated back to the threat actor. On September 6, 2023, Zscaler published a new blog post titled “Steal-It Campaign”. This report provided additional information covering several new attack chains used by BlueDelta, which targeted entities in Australia, Belgium, and Poland.

In October 2023, Insikt Group shared an internal report on BlueDelta activity involving living-off-the-land binaries and abuse of LIS to target European victims. During this campaign, three separate infection chains were observed, which used geo-fencing techniques to exploit victims located only in Austria, Lithuania, and Spain. The report detailed the threat actor's use of the free mock application programming interface (API) services Mockbin and Mocky to survey Windows operating systems and capture NT LAN Manager (NTLM) hashes. BlueDelta used seven different infrastructure stages to filter out sandboxes and incompatible operating systems and to restrict payloads to systems in targeted countries. Victims who failed these checks downloaded a benign file and were redirected to Microsoft’s web portal, msn[.]com, whereas those who passed downloaded a malicious Windows BAT script, which connected to one of the aforementioned free API services to download and run follow-on shell commands.

In December 2023, Proofpoint and IBM published research on a new wave of BlueDelta spearphishing using various lure content to deliver Headlace malware. The campaigns targeted at least thirteen separate nations, as described in this report in phase three.

Analysis
Insikt Group has identified two new phases of BlueDelta activity in which the threat actors deployed new tradecraft and infrastructure to evade detection and increase operational effectiveness. Throughout these new phases, BlueDelta regularly used a free hosting service offered by InfinityFree. InfinityFree provides free subdomains to complement its free hosting service for the following apex domains: *.rf[.]gd, *infinityfreeapp[.]com, *.000[.]pe, *.lovestoblog[.]com, *.kesug[.]com, *.wuaze[.]com, *.great-site[.]net, *.42web[.]io, *.free[.]nf.

Phase-One Infrastructure
As previously reported by Insikt Group, in phase one, BlueDelta redirected victims to the apex domains *.lovestoblog[.]com and *.rf[.]gd at stage one of their attack sequence. BlueDelta then moved to GitHub for redirection for phase two and *.infinityfreeapp[.]com and *.rf[.]gd for phase three.

Throughout phases one to three, BlueDelta used Mocky, a free API hosting service, to host JavaScript filtering and redirection code. The threat actors also used Mockbin, another free API hosting service, for the first two phases, moving to PHP: Hypertext Processor (PHP) scripts hosted on InfinityFree in phase three.

Phase-Two Infrastructure
Beginning September 28, 2023, BlueDelta deployed new first-stage redirection infrastructure to GitHub. The threat actors created two new accounts, "microsoft-update-com” and “windows-update-service”. The accounts each hosted a code repository called “kb5021042”, likely in an attempt to impersonate the Microsoft Windows Update Service. The Microsoft Knowledge Base code “kb5021042” corresponds to a Microsoft update version identifier issued for Windows 10 and Windows Server 2019 in November 2022.

Each GitHub repository contained an identical HTML script titled update.html. The scripts used similar code to the phase-one redirection scripts hosted on InfinityFree. The only difference between the phases was the use of the URL constant id in phase two as opposed to the URL constant q used in phase one. The URL constant id passes the globally unique identifier (GUID) from the stage-one URL and is used in the address of the stage-two Mockbin request. When using the URL constant id in phase two, the full URLs would have been formatted as follows: https://windows-update-service[.]github[.]io/kb5021042/update.html?id=[GUID] and https://microsoft-update-com[.]github[.]io/kb5021042/update.html?id=[GUID].

Following either of the stage-one links redirects the victim to the stage-two script hosted at Mockbin. The stage-two Mockbin script differs slightly from the stage-two script BlueDelta used in phase one, combining several previously used checks into one script. The first function of the phase-two script remains unchanged and prevents automatic scraping or sandboxes from moving to stage three. The second function in the script is new and checks the victim user agent to capture what version of Chrome or Firefox browser they are running. It checks if this value is an integer, and if not, returns false or 0 if Chrome or Firefox are not running on the victim system. The third part of the script checks the victim’s user agent string to ensure they are running a 64-bit version of Windows and checks the results of the first two functions. These determine whether the script is being run in a sandbox, whether the browser is either Chrome or Firefox, and whether its version is over 100. If these checks pass, the JavaScript then redirects the victim to stage three hosted at Mocky; otherwise, the victim is redirected to msn[.]com.

The stage-three script hosted at Mocky remains unchanged from phase one. The script uses the free geo-location API service ipapi, hosted on ipapi[.]co, to perform a geo-location check to ensure the victim is located in the threat actor’s target country. The script also checks whether the victim is running a Windows operating system and has an IPv4 IP address. If all checks pass, a malicious archive file is downloaded via HTML smuggling; otherwise, a benign archive file is downloaded, and the victim is redirected to msn[.]com. In phase two, most of the stage-three scripts that were investigated were no longer accessible, but a sample that contained a geo-fencing restriction for victims in Azerbaijan (AZ) was captured.

The stage-four ZIP payloads were essentially unchanged from the stage-four payloads detected in phase one. The ZIP files contain a BAT script and a benign CAB file for the Windows Update kb5021042. Upon execution, the BAT script creates a visual basic script (VBScript) and an additional BAT script. The VBScript is then executed and calls the newly created BAT script. The only purpose of VBScript is to execute the newly created BAT script. When executed, the newly created BAT script displays a command prompt showing a fake installation of a Windows Update. As per phase one, the new BAT script runs in a loop every five minutes (300 seconds) and downloads a third BAT script (stage six) via Mockbin and Mocky, which masquerades as a CSS file and is run via Microsoft Edge in headless mode. The final downloaded BAT script is then moved to the victim’s C:\ProgramData\ directory before being executed and finally deleted.

The stage-five script, hosted on Mockbin, remains unchanged from phase one. This script checks the victim’s user agent string to ensure it is running a 64-bit version of Windows and whether its browser version is above 100. If the checks pass, the JavaScript redirects the victim to stage six hosted on Mocky; if they fail, it redirects the victim to msn[.]com. The stage-five Mockbin URL is also used to capture the results of stage-six commands.

At the time of investigation, the stage-six scripts hosted at Mocky were returning “404 Not Found” HTTP responses, likely meaning these had been taken down and were not available for analysis. As per phase one, this stage likely contained a second geo-fencing check that, if passed, allowed the victim to download a CSS payload via HTML smuggling, which contained commands to be executed on the victim's machine.

Stage seven remains unchanged from phase one. The stage-five Mockbin URL is used to capture the results of commands executed on the victim system, which are stored as API calls in Mockbin and available to collect by BlueDelta.

Lure Documents and Malware
Insikt Group identified three separate ZIP files used in phase two. The ZIP files contained the first malicious BAT and benign CAB files and no further lure documents. File kb5021042.zip with hash d712744a128b22a0919ecde2508bbfeffa33a61870a941c424e8b301183c44fe was observed. File kb5021042.cmd with hash 7ec80bd3469656f3d8d406a64097d2f0b2bbd1fd0e49f260ae7b28524470c0fe was observed. File update-kb-5021042.zip with hash 54a27464c7ad7f2e32cd123b27c0f9082590cd5ba48526bf00728e8107048f48 was observed. File Install-kb-5021042.cmd with hash 12d98b5c513fe9668661e3fdabb93f595a82a81554f28fbd84658de0aab2a929 was observed. Another file update-kb-5021042.zip with hash 6c0658ac52ca6eb315ab8b6b702a9e24d02d58f24d6d6feb55716b0c05252e51 was observed. File install-kb-5021042.cmd with hash d9be3235d7236ff66c871d4070b98fd0fe46319d0ef04047c1ab4e8c7254d8a5 was observed.

Phase-Three Infrastructure Updates
Beginning October 17, 2023, BlueDelta deployed new infrastructure, which improved several stages of the previous two phases. BlueDelta moved away from hosting first-stage redirection scripts on GitHub and instead used InfinityFree hosting. Additionally, the threat actors moved all operating system filtering and geo-fencing scripts from HTML to PHP, meaning the code was no longer visible to security researchers due to server-side execution. BlueDelta may have implemented this change to make their infrastructure harder to detect and track, or it’s possible the threat actors wanted to move away from the free API hosting service Mockbin, as the service temporarily halted its operations around the time of the change while it updated its service. It’s also possible these changes were in response to public reports exposing BlueDelta’s previous campaigns.

In phase three, a significant increase in targeting was observed, with 27 new first-stage domains and eleven separate payloads uncovered, some of which were recently reported by Trend Micro. Most of the domains seen in phase three followed a similar pattern to those used in the previous two phases, where BlueDelta used a combination of hyphenated words. Some domains appeared to be file downloads, such as file-download[.]infinityfreeapp[.]com. In some instances, the chosen domains showed a lack of creativity by the threat actor, such as fdsagdfg[.]rf[.]gd, or were duplicate domains with letters appended to the end, such as document-c[.]infinityfreeapp[.]com and document-d[.]infinityfreeapp[.]com. The complete list of detected phase-three domains is: calc-dwn[.]infinityfreeapp[.]com, clouddrive[.]infinityfreeapp[.]com, document-c[.]infinityfreeapp[.]com, document-d[.]infinityfreeapp[.]com, documents-cloud[.]infinityfreeapp[.]com, downloadc[.]infinityfreeapp[.]com, downloaddoc[.]infinityfreeapp[.]com, downloadfile[.]infinityfreeapp[.]com, downloadingdoc[.]infinityfreeapp[.]com, downloadinge[.]infinityfreeapp[.]com, downloadingf[.]infinityfreeapp[.]com, downloadingq[.]infinityfreeapp[.]com, downloadingw[.]infinityfreeapp[.]com, downloadx[.]infinityfreeapp[.]com, downloadz[.]infinityfreeapp[.]com, fdsagdfg[.]rf[.]gd, file-download[.]infinityfreeapp[.]com, filedwn[.]infinityfreeapp[.]com, filehosting[.]infinityfreeapp[.]com, filihosting[.]infinityfreeapp[.]com, microsoft-files[.]infinityfreeapp[.]com, online-download[.]infinityfreeapp[.]com, online-drive[.]infinityfreeapp[.]com, online-files[.]infinityfreeapp[.]com, opendoc[.]infinityfreeapp[.]com, opendocument[.]infinityfreeapp[.]com, opendocuments[.]infinityfreeapp[.]com.

Additionally, for phase three, the actors made slight changes to the infrastructure stages, combining previous stages two and three into a single PHP script. Previously, in phase two, stage one, the actors used an HTML redirection script to forward victims to Mockbin. In phase three, the redirection technique was modified to use the web server's root directory, which forwarded victims to a new PHP script called filedwn.php. For example, *.infinityfreeapp[.]com/?id= would redirect to *.infinityfreeapp[.]com/filedwn.php?id=.

In phase three, the aforementioned file filedwn.php replaced the previously used stages two and three in the infection chain. Due to PHP being a server-side programming language, it is not possible to see the actual code used, but it’s assumed that the malicious script carries out similar sandbox, browser, and geo-fencing checks as per the previous stages in phases one and two. If the victim fails the checks, filedwn.php serves the victim a benign ZIP file and redirects them to msn[.]com; if they pass, they receive a malicious ZIP. It is suspected that the threat actors may have added some sort of count function limiting the number of times the malicious payload can be downloaded, as during our research, it was noted that the payload could only be downloaded once, and subsequent requests would receive the benign ZIP file.

The payload for stage three was changed slightly from the previous two phases. One lure theme was “news_week_6” and when decompressed, the ZIP file contained a folder with an executable called news_week_6 and hidden files named calc.cmd, WindowsCodecs.dll, news_week_6, and news_week_6.docx. The news_week_6 executable file is a benign copy of calc.exe that loads WindowsCodecs.dll via dynamic-link library (DLL) search order hijacking. Once loaded, the DLLMain function executes calc.cmd via a call to system(). The news_week_6 executable file had several spaces appended to the file name, which were probably added to hide the fact that it was an executable file.

The calc.cmd script creates similar BAT and VBS files, as seen in phases one and two. It then launches the decoy document news_week_6.docx, removes the malicious payload from the victim’s machine, and replaces it with a copy of the benign payload news_week_6 file. The first line of the calc.cmd script is the same as seen in the first two phases. This creates a VBS script and another BAT script that repeatedly checks in with the command-and-control (C2) for new payloads masquerading as CSS files. The calc.cmd script then continues by killing any running instances of WINWORD.exe, removing the malicious artifacts from its payload, copying the benign copy of its payload into the user’s download directory, and then opening the decoy document.

A minor change to the BAT script used to retrieve a new CSS payload was observed. When running Microsoft Edge in headless mode, rather than using the URL for the C2, an encoded HTML page is instead provided. When Microsoft Edge loads the encoded page, a JavaScript script redirects the browser to an infinityfreeapp[.]com URL rather than Mockbin, as used in phases one and two.

The stage-four script, execdwn.php, was also changed to PHP from HTML and is hosted at InfinityFree rather than Mockbin. The content of this script is not viewable, but it is expected to be similar to the previous stage-five script containing JavaScript. The script conducts browser and operating system checks before forwarding the victim to a final payload hosted at Mocky, which contains commands to be executed on the victim's system. As per the previous Mockbin file, this stage is also used to capture the output of these commands after stage six for the actors to collect.

Several payload scripts were captured in this phase. The scripts remained the same as those found in phase one and contained a second geo-fencing check that, if passed, allowed the victim to download a malicious CSS payload via HTML smuggling, which contained commands to be run on the victim's machine. The final CSS payload was updated slightly compared to phases one and two. BlueDelta printed the username and userdomain to a file rather than using the whoami command. At stage six, BlueDelta sent the results of the commands run on the victim system to the PHP file execdwn.php rather than Mockbin, as in phases one and two.

Phishing Emails and Lure Documents
Insikt Group uncovered one phishing email linked to BlueDelta’s phase-three campaign. The email appeared to be sent from the Chancellery of the Prime Minister in Poland and used a report on the human rights of Palestine and Arab-occupied territories as a lure. The email contained a hyperlink to opendoc[.]infinityfreeapp[.]com, with the display text war.zip. Following the link downloads a malicious ZIP file containing a legitimate, publicly available United Nations document entitled “Report of the Special Committee to Investigate Israeli Practices Affecting the Human Rights of the Palestinian People and Other Arabs of the Occupied Territories”, alongside hidden files. These files provide similar functionality to those described earlier in the report, in phase three, stage three. IBM previously reported this lure document in December 2023.

Insikt Group uncovered fourteen separate ZIP files that contained BlueDelta lure material throughout phase three. Most of the lure content is related to recent news or political events, like a file previously reported by Proofpoint, SEDE-PV-2023-10-09-1_EN.zip, which contained minutes from an October European parliament meeting. The ZIP file Zeyilname.zip contained a lure document written in Turkish with a translated title of “BSYD Technical Certificate Form Addendum”. The file contained content to define server specifications. The last detected activity in phase three was in December 2023. Since then, BlueDelta likely ceased using InfinityFree hosting and favored hosting infrastructure on webhook[.]site and mocky[.]io directly, as explained in recent reporting by CERT Polska. Additionally, BlueDelta has started using the apex domain firstcloudit[.]com, available from the free hosting company DriveHQ. As reported by IBM, BlueDelta started using a new backdoor, MASEPIE, in November 2023, which overlaps slightly with the last use of Headlace in phase three.

BlueDelta Credential Harvesting
While analyzing the LIS BlueDelta frequently abused, Insikt Group uncovered some recent credential harvesting pages that were active in March 2024. The credential harvesting pages can be attributed to BlueDelta because, in some instances, compromised Ubiquiti Edge routers were used to capture credentials. The secure socket shell (SSH) banners found on the Ubiquiti routers match the format of SSH banners recently highlighted in a report by the FBI, NSA, US Cyber Command, and international partners that detailed BlueDelta's use of Ubiquiti EdgeRouters for infrastructure.

In addition to using Ubiquiti EdgeRouters, some of the detected pages used the following free API and hosting services alongside the InfinityFree apex domains mentioned at the beginning of the analysis section of the report: Webhook[.]site - webhook[.]site, Pipedream - pipedream[.]com, Mocky - mocky[.]io, Forge - getforge[.]com. BlueDelta used these free LIS for page- and code-hosting, credential capture, and exfiltration. Eighteen pages that were active between March 2022 and March 2024 were uncovered. Google’s Threat Analysis Group (TAG) and Sekoia previously attributed some of the pages to BlueDelta.

Several pages targeted Ukrainian news and webmail provider ukr[.]net users. A recent page hosted on Mocky, which impersonates ukr[.]net, was detected in February 2024. The malicious ukr[.]net page uses JavaScript to exfiltrate credentials to a compromised Ubiquiti EdgeRouter with IP address 73.80.9[.]137 via TCP port 35770. After the credentials are submitted to the router from the harvesting page, the script waits for one of five responses: “Finlay”, “Redirect”, “AGAIN”, “BAD”, or “DATA=”. Insikt Group was unable to recover the malicious script hosted on the compromised router, but it is assumed that it can also relay any CAPTCHA challenges issued by the legitimate website, as described in the Sekoia report mentioned above. This can be assumed due to similar JavaScript functions noted on the harvesting page.

In March 2023, a second BlueDelta credential harvesting webpage was detected hosted on InfinityFree, which exfiltrates victim credentials to webhook[.]site. The webpage impersonates a password change page from the email and website hosting company Turbify, using the domain turbify-biz-cesdaz[.]rf[.]gd. The Turbify page contains a malicious JavaScript element that redirects victims to mail[.]cesd[.]az after credentials are submitted, suggesting that users of this domain were the intended targets. The domain cesd[.]az is associated with a leading independent think tank, the Center for Economic and Social Development (CESD), in Azerbaijan. Recent research by the CESD includes “Assessment of the economic relations between Azerbaijan and the European Union in the context of the Russian-Ukrainian war” and “The 12th sanctions package against Russia; Evaluation of the possible impacts of the economy of Azerbaijan”, likely making them a potential intelligence target for Russian espionage. Insikt Group could not find any additional pages matching the Turbify theme, likely suggesting that this is a custom page created solely to target the CESD.

In March 2024, Insikt Group uncovered another credential harvesting page impersonating the popular webmail software provider MDaemon. The webpage was hosted on the InfinityFree domain consumerpanelapp[.]42web[.]io and exfiltrated victim data to pipedream[.]com. The MDaemon credential harvesting page displayed a loading bar, which, once complete, displayed the message “No undelivered messages for you”. Underneath the loading bar was a hyperlink that displayed the text “Back to inbox”. If clicked, this hyperlink would redirect users to the page mail2[.]progress[.]gov[.]ua, which is associated with the Ukrainian company State Enterprise Company Specialized Foreign Trade Firm PROGRESS (SE SZTF "PROGRES"), an official importer and exporter of military goods and services based in Ukraine. The credential harvesting page linked image resources from a different legitimate webmail page rather than hosting them locally. Some of the images were directly linked from the website ukrinmash[.]com. Ukrinmash is also an official Ukrainian importer and exporter of military goods and services; therefore, it is highly likely that this credential harvesting page has previously been used to target Ukrinmash, and BlueDelta has modified it slightly to target SE SZTF "PROGRES" without updating the images. Another MDaemon login webpage, delivery-ukrinmash-service[.]infinityfreeapp[.]com, was detected directly targeting Ukinmarsh. It is possible this was the page modified by the threat actors to target SE SZTF "PROGRES".

A similar MDaemon login webpage was also detected, first seen in July 2023. The webpage was hosted on pipedream[.]com and exfiltrated credentials to a different Pipedream API endpoint. The webpage contained the same progress bar as the aforementioned MDaemon page but redirected victims to the domain mail[.]ste[.]kiev[.]ua after they clicked the Back to Inbox button, suggesting that users of mail[.]ste[.]kiev[.]ua were the intended victims. The domain ste[.]kiev[.]ua is associated with the State Foreign Trade Enterprise “SpetsTechnoExport”, a Ukrainian state-owned company that imports and exports weapons, military products, technologies, and special-purpose equipment.

Insikt Group uncovered five credential harvesting pages targeting Yahoo webmail users. These pages were hosted using InfinityFree domains or pipedream[.]net and exfiltrated user credentials to compromised Ubiquiti EdgeRouters via fixed high-ephemeral ports. The domains targeting Yahoo users were: eo6kgbwpysq0laa[.]m[.]pipedream[.]net, eogo85tybrrn2r[.]m[.]pipedream[.]net, eottxji4yk4vg5x[.]m[.]pipedream[.]net, eoy6vrzslpn9vu[.]m[.]pipedream[.]net, xzdgsdfhfgtjdfj[.]wuaze[.]com. Some of these pages displayed fake account activity pages that claimed the victim’s accounts had been logged into by unauthorized users located in Belarus, China, and Iran. The page also suggested that the user should reset the password associated with these accounts.

Insikt Group detected a Yahoo-themed credential harvesting page hosted on the InfinityFree domain xzdgsdfhfgtjdfj[.]wuaze[.]com, which was active in September 2023. The page exfiltrated data to a compromised Ubiquiti EdgeRouter linked to the IP address 73.80.9[.]137 and used updated code similar to the previously described pages. The updated code uses the XMLHttpRequest JavaScript object to send the captured credentials to a script hosted on a compromised router. It then waits for a response and examines the data returned by responseText before displaying specific dynamic web content to the victims depending on the returned string, for example: “OPDATA”, “BAD-VCODE”, “OPTIONS”, “Finaly”, “AGAIN”, “CHANGE, BAD, BAD-PASSWORD, BAD-CODE, YAK-CODE, and PUSH”. At the time of analysis, Insikt Group was unable to recover the malicious script hosted on the compromised Ubiquiti EdgeRouter. However, per the ukr[.]net credential harvesting pages described previously, we can assume the scripts will be functionally similar to those previously described by Sekoia. In this case, they would likely enable BlueDelta to bypass two-factor authentication (2FA) by relaying authentication codes back to Yahoo.

Victimology
Upon analyzing Headlace geofencing scripts and countries targeted by credential harvesting campaigns from 2022 onwards, Insikt Group identified that thirteen separate countries were targeted by BlueDelta. As expected, Ukraine topped the list, accounting for 40% of the activity. Türkiye might seem like an unexpected target with 10%, but it's important to note that it was singled out only by Headlace geofencing, unlike Ukraine, Poland, and Azerbaijan, which were targeted through both Headlace geofencing and credential harvesting.

Mitigations
Establish real-time alerts to detect typosquat domains that mimic your brand. This proactive measure helps guard against entities like BlueDelta, which could exploit these domains for credential harvesting and phishing. Use Identity Intelligence to monitor, detect, and mitigate widespread credential leaks and theft, enhancing account protection. Implement multi-factor authentication (MFA) to add an extra layer of security and make it more challenging for attackers to abuse compromised credentials. Monitor reporting for the latest threat actor tradecraft, TTPs, targeting, and indicators of compromise (IoCs) to ensure you are informed of the threat. Use this intelligence to provide comprehensive training on email security best practices, including identifying phishing emails, suspicious attachments, and links. Regularly reinforce training to maintain a high level of awareness and vigilance. Assess suspicious email attachments for instant analysis to quickly assess and understand the associated threats. Monitor your company's attack surface to automate the detection of potential entry points for attackers and highlight network configuration changes. Ensure that both software and browser updates are prioritized and installed regularly. Updates often include patches for vulnerabilities and replace outdated plug-ins and add-ons, making it harder for threat actors to exploit these vulnerabilities to compromise a device. Implement a domain name system (DNS)-blocking policy to prevent connections to free hosting apex domains, such as those used by InfinityFree and free API services, if your company does not use them. Participate in Collective Insights to harness the power of the Intelligence Cloud and customer signals to give visibility into threats based on your environment, industry, and in-the-wild incidents.

Outlook
Insikt Group anticipates that BlueDelta will continue the operations detailed in this report, with an intensified emphasis on gaining insights into operational capabilities and potential vulnerabilities in Ukraine's defense sector. BlueDelta’s objective is to acquire intelligence that bolsters Russia's military endeavors in Ukraine and gather insights into geopolitical dynamics in neighboring nations and NATO member states. The adaptability, skill, and ferocity demonstrated in this report will continue at pace as Russia tries to capture intelligence, which gives it an edge on the battlefield and regarding geopolitical interests.

Indicators
Headlace Domains: calc-dwn[.]infinityfreeapp[.]com, clouddrive[.]infinityfreeapp[.]com, document-c[.]infinityfreeapp[.]com, document-d[.]infinityfreeapp[.]com, documents-cloud[.]infinityfreeapp[.]com, downloadc[.]infinityfreeapp[.]com, downloaddoc[.]infinityfreeapp[.]com, downloadfile[.]infinityfreeapp[.]com, downloadingdoc[.]infinityfreeapp[.]com, downloadinge[.]infinityfreeapp[.]com, downloadingf[.]infinityfreeapp[.]com, downloadingq[.]infinityfreeapp[.]com, downloadingw[.]infinityfreeapp[.]com, downloadx[.]infinityfreeapp[.]com, downloadz[.]infinityfreeapp[.]com, fdsagdfg[.]rf[.]gd, file-download[.]infinityfreeapp[.]com, filedwn[.]infinityfreeapp[.]com, filehosting[.]infinityfreeapp[.]com, filihosting[.]infinityfreeapp[.]com, microsoft-files[.]infinityfreeapp[.]com, online-download[.]infinityfreeapp[.]com, online-drive[.]infinityfreeapp[.]com, online-files[.]infinityfreeapp[.]com, opendoc[.]infinityfreeapp[.]com, opendocument[.]infinityfreeapp[.]com, opendocuments[.]infinityfreeapp[.]com.

Benign Files (SHA256): d5eb88c1fe88e274a9212ff6647e8220f1bfbc250e0e891f60ea8a28afc9b19c - 2023-12-bois-position-on-accessing-capital-pr.zip, 2f498a25049f89a809550a11e379912ac053eba881470ddd3a4e2b487a31c2d0 - 20231113_ROU_ROAD_MOV_REQUEST-NATOTF20231113NN001-302.zip, 763d47f16a230f7c2d8c135b30535a52d66a1ed210596333ca1c3890d72e6efc - calc.war.zip, 0a5109479620c4c567928680f8e4be685a74e4b31efaa98811f3b54992697e2d - IN11897.zip, bbe435a3f0adb1ef4810d22ed74f5eba8907201cba01230b8c98dbe5963e11a8 - news_week_6.zip, f70c4f5f417b7360a9edb493ac2bc982bc59a18eee064825c859ad889b0be167 - Roadmap.zip, 07c06492d3252236579097d5b114bbbea2173255b017fb26df7217ea986d6d10 - SEDE-PV-2023-10-09-1_EN.zip, 8dba6356fdb0e89db9b4dad10fdf3ba37e92ae42d55e7bb8f76b3d10cd7a780c - SEDE-PV-2023-10-09-1_EN.zip, 555eafd28474cf01b5eea4648ec6b417d08d17aba151c5592c8843672812cffa - SEDE-PV-2023-10-09-1_EN.zip, 8cc664ff412fc80485d0af61fb0617f818d37776e5a06b799f74fe0179b31768 - war.zip, b0604f58c55fdba4c4381e411689b29c031dbce3fb16c656a6b5fadb578deb76 - war.zip, 2f1c2afdf17831e744841029bb5d5a3ea9fda569958303be03e50fb3a764913f - Zeyilname.zip.

Malware Samples (SHA256): f9f8ca7fa979766c168d7162df572f3549c7af2e707e5a5ac8e06bd352bb7399 - IN11897.zip, a0a67412968c10224e04bfbe32e6012b34e4a4ecc36fc72332101b90acec8fa4 - 2023-12-bois-position-on-accessing-capital-pr.zip.

New Credential Harvesting IP Addresses/Domains: 37.191.122[.]186:3578, 73.80.9[.]137:35780, consumerpanelapp[.]42web[.]io, delivery-ukrinmash-service[.]infinityfreeapp[.]com, eo1ws2wgj75rdfd[.]m[.]pipedream[.]net, eo6kgbwpysq0laa[.]m[.]pipedream[.]net, eogo85tybrrn2r[.]m[.]pipedream[.]net, eomhv6vdu4v5qyt[.]m[.]pipedream[.]net, eoytfd39hbrspa3[.]m[.]pipedream[.]net, run.mocky[.]io/v3/4e14d583-bbf5-4af3-9a86-4c0938a7802a, turbify-biz-cesdaz[.]rf[.]gd, webhook[.]site/e7f39f18-bcb3-40e3-9e82-8cf7f807cc80, xgfdstu6k.frge[.]io, xzdgsdfhfgtjdfj[.]wuaze[.]com.

Existing Credential Harvesting IP Addresses/Domains: 37.191.122[.]186:3578, 68.76.150[.]97:8080, 174.53.242[.]108:8080, consumerpanel0x254a2[.]frge[.]io, eos93vb2cwsu3xf[.]m[.]pipedream[.]net, eottxji4yk4vg5x[.]m[.]pipedream[.]net, eoy6vrzslpn9vu[.]m[.]pipedream[.]net, eoytfd39hbrspa3[.]m[.]pipedream[.]net, hatdfg-rhgreh684[.]frge[.]io, id-unconfirmeduser[.]frge[.]io, panelunregistertle-348[.]frge[.]io, setnewcred[.]ukr[.]net[.]frge[.]io, settings-panel[.]frge[.]io, ua-consumerpanel[.]frge[.]io, ukrprivacysite[.]frge[.]io, webhook[.]site/d466f7a7-63a1-4c04-8347-fe2d0a96081f, webhook[.]site/f5eace0b-062b-402f-a006-63b97e4950c3.

Mitre ATT&CK Techniques
Tactic: Resource Development: Technique: Acquire Infrastructure: Domains ATT&CK Code: T1583.001
Tactic: Resource Development: Technique: Acquire Infrastructure: Web Services ATT&CK Code: T1583.006
Tactic: Resource Development: Technique: Stage Capabilities: Upload Malware ATT&CK Code: T1608.001
Tactic: Resource Development: Technique: Stage Capabilities: Link Target ATT&CK Code: T1608.005
Tactic: Initial Access: Technique: Spearphishing Attachment ATT&CK Code: T1566.001
Tactic: Initial Access: Technique: Spearphishing Link ATT&CK Code: T1566.002
Tactic: Execution: Technique: Command and Scripting Interpreter: PowerShell ATT&CK Code: T1059.001
Tactic: Execution: Technique: Command and Scripting Interpreter: Windows Command Shell ATT&CK Code: T1059.003
Tactic: Execution: Technique: Command and Scripting Interpreter: Visual Basic ATT&CK Code: T1059.005
Tactic: Execution: Technique: Command and Scripting Interpreter: JavaScript ATT&CK Code: T1059.007
Tactic: Defense Evasion: Technique: Virtualization/Sandbox Evasion: System Checks ATT&CK Code: T1497.001
Tactic: Defense Evasion: Technique: Hide Artifacts: Hidden Window ATT&CK Code: T1564.003
Tactic: Credential Access: Technique: Web Portal Capture ATT&CK Code: T1056.003
Tactic: Credential Access: Technique: Multi-Factor Authentication Interception ATT&CK Code: T1111
Tactic: Discovery: Technique: System Owner/User Discovery ATT&CK Code: T1033
Tactic: Command and Control: Technique: Web Service: Dead Drop Resolver ATT&CK Code: T1102.001
Tactic: Command and Control: Technique: Web Service: One-Way Communication ATT&CK Code: T1102.003
Tactic: Command and Control: Technique: Standard Encoding ATT&CK Code: T1132.001