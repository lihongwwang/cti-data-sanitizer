APT-C-08（蔓灵花）是一个拥有南亚地区政府背景的APT组织，近几年来持续发起针对南亚及周边国家的APT攻击，主要攻击政府、驻外机构、高校和军工行业等相关单位。

该组织攻击近年来载荷变化多样，出现了wmRAT远控、.NET特马、ORPCBackdoor、以及MiyaRat等类型。近期我们在日常威胁狩猎中捕获了蔓灵花组织新的恶意载荷，该RAT类型还未被公开披露，载荷还处于开发初期，不断迭代中，鉴于此，本文将重点披露蔓灵花组织使用的这种载荷，以便用户及时发现，避免中招。

一、载荷分析

通过对蔓灵花组织的持续追踪，我们捕获了蔓灵花组织服务器上的攻击组件，下面就其中一个新的RAT进行详细分析，该样本基本信息如下。根据样本下载时的文件名gsxviewm.exe，同时为了与之前命名的wmRAT载荷相呼应，我们将此类载荷统一归类为gmRAT类型。

MD5 3d6fc4d98e89f2d69341d944cfc104f4
文件名 gsxviewm.exe
文件大小 395kb (403,968 字节)

样本执行时首先获取C2域名(pololiberty.com)对应的IP地址，将端口设置为56218。
然后通过socket套接字链接C2服务器，实现Client上线。
接着等待服务器响应，同时获取受害主机基本信息，例如“username”，“hostname”，“进程路径”，“OS版本”，“isAdm”，“vid”等信息并发送。

该类型木马最主要的功能是接受C2服务器下发指令并响应，其支持的相关指令信息如下所示。

命令 功能
pwd 获取工作目录
cd 进入指定目录
dir 获取目录信息
cp 复制文件
rm 删除文件
mv 移动文件
run_process 创建进程
uploadfol 上传文件目录信息
upload 上传
cont_upload 继续上传
CNL_UP 取消上传
StartTransmit 开始传输
download 下载
kill_process 结束进程
shell 以cmd执行命令
pshell 以powershell执行命令
list_drives 列举磁盘
client_ver 客户端版本
reg_query 疑似查询注册表（暂未上线）
reg_add 疑似写入注册表（暂未上线）
screenshot 截图

下面对该木马涉及的具体指令进行分析。

dir
列出目录文件信息。如果是目录，则输出[DIR]<name> [DT]:<timestamp>。如果是文件，计算文件大小(以B、KB、MB、GB、TB为单位)，输出[FIL]<name> [DT]:<timestamp> [SZ]:<size>。

uploadfol
递归遍历目录下的文件，统计目录大小，并输出为<FOLNM>目录名<SZ>目录大小发送到服务器。

upload & cont_upload
两个指令功能相近，都是读取文件上传，不同在于upload是直接上传，标志位是“[UPL]<FN>”， cont_upload指令是继续上传，标志位是“[UPF]”。

CNLUP
通过终止对应的异步读写操作，取消文件上传。

StartTransmit
开始数据传输，支持递归继续发送未完成部分，每次最多发送64KB（0x10000字节）,发送结束后发出标志性字符串[DWS]filename=进行通知。

download
文件下载，提取标志“<SZ>:”后面的数据保存到默认目录C:\\Programdata\\下。

shell & pshell
如果是shell指令则创建cmd shell，如果是pshell则创建powershell shell。

list_drives
查看磁盘信息。

screenshot
屏幕截屏，并保存到C:\\Users\\public\\pictures\\ss.jpg。

cp
文件复制。

rm
删除文件。

mv
使用MoveFileExW移动文件。

run_process
创建进程。

pwd
获取工作目录，实际为C:\\Programdata。

kill_process
关闭进程。

client_ver & cd & reg_query & reg_add
client_ver指令直接返回客户端版本beta_v1.0，从beta_v1.0也可以看出这个RAT还处于持续开发中。
cd指令有多个功能包括输出当前工作目录、返回上一级目录，或者进入指定路径。
reg_query和reg_add指令暂时未上线，通过名字可知是注册表查询及注册表写入。

二、关联分析

同期，我们还捕获到与该样本代码基本一致的同类样本，基本信息如下：
MD5 c0a438d69ae731ad705c46ac5209c8cc
文件名 gviewstc.exe
文件大小 395kb (403,968 字节)
时间戳 2025-04-10 00:26:09

该同类样本在2025-05-23日被上传至VT，已存在多天，但最新查杀率依然较低，可见蔓灵花组织的新攻击载荷具有较好免杀性。
由于该样本功能与上述分析的样本基本一致，所以相关功能不再详细叙述。

三、归属研判

该恶意载荷下载源为蔓灵花组织（APT-C-08）长期活跃的C2服务器，该服务器历史攻击活动中曾多次分发wmRAT变种及.NET平台恶意程序，并通过特定URL路径（含%computername%_%username%等系统环境变量特征)）收集受害者敏感数据；基于攻击基础设施复用规律、载荷下载模式与攻击目标的高度关联性，本次发现的新型攻击组件可明确归因至蔓灵花组织攻击体系。

总结

APT-C-08（蔓灵花）组织近年来一直很活跃，持续开发各类新型组件，展现高度专业化趋势，其攻击活动背后存在强大的经济支撑和人员配备。本文针对蔓灵花组织使用的新载荷gmRAT进行了详细分析，希望能让用户对这类攻击组件有所防范。在这里也提醒用户加强安全意识，在日常工作中要对未知邮件、超链接、样本保持警惕，切勿随便点击。这些行为可能导致系统在没有任何防范的情况下被攻陷，从而导致机密文件和重要情报的泄漏。