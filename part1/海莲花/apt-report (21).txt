2022/6/2 09:31 黑客组织“海莲花”作战武器“Buni”最新曝光，瞄准Linux平台

黑客组织“海莲花”作战武器“Buni”最新曝光，瞄准Linux平台
原创 睡不醒菜 微步在线研究响应中心 2022-06-01 17:53 发表于北京

收录于合集
#安全报告 59 #APT 28 #海莲花 1 #Buni 1

1

 概述


“海莲花”，又名 APT32 和 OceanLotus，是来自东南亚地区的黑客组织。该组织至少自2012
年开始活跃，长期针对中国能源行业、海事机构、边防机构、卫生部门、海域建设部门、科研院
所和航运企业等进行网络攻击。除中国外，“海莲花”的目标还包含全球的政府、军事机构和大型
企业，以及本国的媒体、人权和公民社会等相关的组织和个人。

在历史攻击手法中，APT32 一直在尝试不同方法以实现在目标系统上执行恶意代码和绕过安全
检测。微步情报局长期对 APT32 的研究与对抗中，于去年下半年捕获到了 APT32 一个未公开
的 Linux 后门 “Buni”，并且在威胁狩猎系统的持续监控下发现近期又再度开始活跃。

2

详情


微步情报局在2021年调查 APT32 资产的过程中，发现 APT32 另外一款未被披露的 Linux 后
门，后门设计思路与 APT32 的 “双头龙” 和 MacOS 后门较为相似。这一款后门同样具备结构
化流量，在单一进程实例、信息收集、C2编码等技术特点和“双头龙“几乎一致，但指令类型有所
不同，并且流量加密方式较为简单，分析人员在后门信息收集中使用到命令“/dev/disk/by-
uuid/”和“cat /etc/*release | uniq”中摘取 By 和 uniq 两个单词的前缀，将其命名为 Buni。

起初分析师以为 Buni 是“双头龙“的前身，属于 APT32 不再使用的武器，但在近期中发现这一
款 Linux 后门又再度活跃。Buni 后门中硬编码的 C2利用了一些失陷 IoT 设备，并且其控制的
主机数量较多，Buni 历史样本文件中的硬编码 C2 使用了长达2年半之久。截至2022年，Buni

https://mp.weixin.qq.com/s/zHLY81XeNL8afYaPtd0Myw 1/8



2022/6/2 09:31 黑客组织“海莲花”作战武器“Buni”最新曝光，瞄准Linux平台

部分样本在VT平台保持了整整两年的0杀软检测效果；截止至最新时间，也仅仅只有两款杀软检
出。




3

样本特点


1.释放方式

a)Buni 由安装程序和 Core 两部分构成，安装程序负责释放 Core 和维持权限两部分操作，执
行完后会被删除，在观测到的安装程序中使用了 “crontab” 维持权限的方式。

b)沙箱进程关系，如下图所示：

2.单一进程实例

Buni 通过文件锁定实现单一进程实例，在 root 和非 root 权限会有两种不同的路径，分别为
“/tmp/.etxh” 和 “/tmp/.edv”。

代码层如下所示：

https://mp.weixin.qq.com/s/zHLY81XeNL8afYaPtd0Myw 2/8



2022/6/2 09:31 黑客组织“海莲花”作战武器“Buni”最新曝光，瞄准Linux平台

3.进程伪装

Buni 通过随机函数产生6-12的随机长度字符串，调用 prctl 函数设置随机进程名称，伪装成系
统进程。

4.C2编码方式

C2 字符串硬编码存放在 .data 段中，在后门加载后和 0xB1 字节异或解密。

5.信息收集

https://mp.weixin.qq.com/s/zHLY81XeNL8afYaPtd0Myw 3/8



2022/6/2 09:31 黑客组织“海莲花”作战武器“Buni”最新曝光，瞄准Linux平台

Buni 通过各类系统命令收集系统的基本信息，包括：CPU 架构、进程 PID、用户名、主机名、
网卡信息等，此外，在生成的数据包中还携带了各种常量，最终将各类信息拼接形成一个数组格
式的数据包，可以通过 JSON 解析。

具体调用的函数\命令，如下表格所示：

命令\函数

Uname

cat /etc/*release | uniq

cat /etc/issue

Gethostname

Sysinfo

readlink /proc/self/exe

/proc/cpuinfo

a)uname

b)cat /etc/*release | uniq & cat /etc/issue

c)gethostname

d)sysinfo

e)获取各类信息构成的数据，会在上线请求时一并被发送，格式化后的数据如下：

https://mp.weixin.qq.com/s/zHLY81XeNL8afYaPtd0Myw 4/8



2022/6/2 09:31 黑客组织“海莲花”作战武器“Buni”最新曝光，瞄准Linux平台

6.结构化流量

a)Buni 拥有其自定义的通信协议，通信数据包具有一定的结构，数据在构造后经过 XOR 加
密，部分命令会存在附加数据，附加数据部分通过 GZIP 方式压缩，其流量结构如下：

b)类C结构表示如下：

c)在代码中则是通过逐字节 recv 接收的方式解析成流量结构：

7.指令分发&响应

https://mp.weixin.qq.com/s/zHLY81XeNL8afYaPtd0Myw 5/8



2022/6/2 09:31 黑客组织“海莲花”作战武器“Buni”最新曝光，瞄准Linux平台

a)指令解析和响应包的构造在同一个函数中所实现，在接收到服务端发送的数据包后逐字节解析
后被传入该函数，对解析得到的指令类型执行对应的操作。

b)在指令分发执行完成后，会构造相同类型数据包进行应答，在响应包中会携带执行结果与错误
号。

c)具体支持的指令类型，如下表所示：

说明 类型

上线信息 0x5C37

命令执行\运行插件 0x5C7C

交付文件 0xB616、0x1CE3

心跳（指定睡眠时间） 0xDAFE


 0x7221


 0x48B8

3

 总结


https://mp.weixin.qq.com/s/zHLY81XeNL8afYaPtd0Myw 6/8



2022/6/2 09:31 黑客组织“海莲花”作战武器“Buni”最新曝光，瞄准Linux平台

APT32 拥有 Windows、Linux、MacOS 等不同操作系统的作战武器，覆盖移动端、桌面端、
IoT多平台，纵观 Linux 和 MacOS 平台中的作战工具同源程度，这必然是属于同一公司所开发
的工具，在同一源码上不停的分化迭代，形成了各种针对多架构、多平台、多操作系统的不同类
型作战武器。

4

 IOC


C2

zabbixasaservice.com
139.162.58.101

- END -


关于微步在线研究响应中心

微步情报局，即微步在线研究响应中心，负责微步在线安全分析与安全服务业
务，主要研究内容包括威胁情报自动化研发、高级 APT 组织&黑产研究与追
踪、恶意代码与自动化分析技术、重大事件应急响应等。

微步情报局由精通木马分析与取证技术、Web
攻击技术、溯源技术、大数
据、AI 等安全技术的资深专家组成，并通过自动化情报生产系统、云沙箱、
黑客画像系统、威胁狩猎系统、追踪溯源系统、威胁感知系统、大数据关联知
识图谱等自主研发的系统，对微步在线每天新增的百万级样本文件、千万级
URL、PDNS、Whois 数据进行实时的自动化分析、同源分析及大数据关联
分析。微步情报局自设立以来，累计率先发现了包括数十个境外高级 APT 组
织针对我国关键基础设施和金融、能源、政府、高科技等行业的定向攻击行
动，协助数百家各个行业头部客户处置了肆虐全球的 WannaCry 勒索事件、
BlackTech 定向攻击我国证券和高科技事件、海莲花长期定向攻击我国海事/
高科技/金融的攻击活动、OldFox 定向攻击全国上百家手机行业相关企业的
事件。

内 容 转 载 与 引 用

1 .  内 容 转 载 ， 请 微 信 后 台 留 言 ： 转 载 + 转 载 平 台

2 .  内 容 引 用 ， 请 注 明 出 处 ： 以 上 内 容 引 自 公 众 号 “ 微 步 在 线 研 究 响 应 中 心 ”

点击下方名片，关注我们


https://mp.weixin.qq.com/s/zHLY81XeNL8afYaPtd0Myw 7/8



2022/6/2 09:31 黑客组织“海莲花”作战武器“Buni”最新曝光，瞄准Linux平台

第一时间为您推送最新威胁情报

文章已于2022-06-01修改

https://mp.weixin.qq.com/s/zHLY81XeNL8afYaPtd0Myw 8/8